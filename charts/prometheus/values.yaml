kube-prometheus-stack:
  global:
    rbac:
      create: true
      createAggregateClusterRoles: false

  prometheus:
    enabled: true

    service:
      type: LoadBalancer
      annotations:
        service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
        service.beta.kubernetes.io/aws-load-balancer-scheme: "internet-facing"

    prometheusSpec:
      retention: 15d
      retentionSize: "50GB"

      storageSpec:
        volumeClaimTemplate:
          spec:
            storageClassName: ebs-sc
            accessModes: ["ReadWriteOnce"]
            resources:
              requests:
                storage: 50Gi

      resources:
        requests:
          cpu: 100m
          memory: 512Mi
        limits:
          cpu: 500m
          memory: 1Gi

      serviceMonitorSelector: {}
      serviceMonitorNamespaceSelector: {}
      podMonitorSelector: {}
      podMonitorNamespaceSelector: {}
      additionalScrapeConfigs: []
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        fsGroup: 2000
      podDisruptionBudget:
        enabled: false
        minAvailable: 1

  grafana:
    enabled: false

  alertmanager:
    enabled: true

    service:
      type: ClusterIP

    alertmanagerSpec:
      storage:
        volumeClaimTemplate:
          spec:
            storageClassName: ebs-sc
            accessModes: ["ReadWriteOnce"]
            resources:
              requests:
                storage: 5Gi

      resources:
        requests:
          cpu: 50m
          memory: 64Mi
        limits:
          cpu: 100m
          memory: 128Mi

      retention: 120h

    config:
      global:
        resolve_timeout: 5m

      route:
        group_by: ['alertname', 'cluster', 'service']
        group_wait: 10s
        group_interval: 10s
        repeat_interval: 12h
        receiver: 'null'
        routes:
          - match:
              alertname: Watchdog
            receiver: 'null'

      receivers:
        - name: 'null'

  prometheus-node-exporter:
    enabled: true

    resources:
      requests:
        cpu: 25m
        memory: 32Mi
      limits:
        cpu: 100m
        memory: 64Mi

    prometheus:
      monitor:
        enabled: true

  kube-state-metrics:
    enabled: true

    resources:
      requests:
        cpu: 25m
        memory: 64Mi
      limits:
        cpu: 100m
        memory: 128Mi

    prometheus:
      monitor:
        enabled: true

  prometheusOperator:
    enabled: true

    resources:
      requests:
        cpu: 50m
        memory: 64Mi
      limits:
        cpu: 200m
        memory: 256Mi

    tls:
      enabled: false

    admissionWebhooks:
      enabled: false

  coreDns:
    enabled: false

  kubelet:
    enabled: true
    namespace: kube-system

  kubeApiServer:
    enabled: false

  kubeControllerManager:
    enabled: false

  kubeScheduler:
    enabled: false

  kubeEtcd:
    enabled: false

  kubeProxy:
    enabled: false

environment: base

namespace: monitoring
